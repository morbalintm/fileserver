<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WebNAS OS</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,sans-serif}

body{
    height:100vh;
    background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    overflow:hidden;
    color:white;
}

/* LOGIN */

#loginScreen{
    display:flex;
    justify-content:center;
    align-items:center;
    height:100%;
}

.loginBox{
    background:rgba(255,255,255,0.1);
    backdrop-filter:blur(25px);
    padding:40px;
    border-radius:20px;
    width:300px;
}

input{
    width:100%;
    margin:10px 0;
    padding:8px;
    border:none;
    border-radius:8px;
}

/* DESKTOP */

#desktop{
    display:none;
    width:100%;
    height:100%;
    position:relative;
}

/* TOPBAR */

#topbar{
    height:50px;
    background:rgba(255,255,255,0.1);
    backdrop-filter:blur(20px);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 20px;
}

/* SIDEBAR */

#sidebar{
    position:absolute;
    top:50px;
    left:0;
    width:200px;
    bottom:0;
    background:rgba(0,0,0,0.3);
    padding:10px;
}

.appBtn{
    padding:10px;
    margin:10px 0;
    cursor:pointer;
    background:rgba(255,255,255,0.1);
    border-radius:10px;
}

/* WINDOW */

.window{
    position:absolute;
    width:600px;
    height:400px;
    background:rgba(255,255,255,0.1);
    backdrop-filter:blur(30px);
    border-radius:15px;
    box-shadow:0 0 40px rgba(0,0,0,0.4);
    overflow:hidden;
}

.window-header{
    padding:10px;
    background:rgba(255,255,255,0.15);
    cursor:move;
    display:flex;
    justify-content:space-between;
}

.window-content{
    padding:15px;
    height:calc(100% - 40px);
    overflow:auto;
}

button{
    padding:6px 10px;
    border:none;
    border-radius:6px;
    cursor:pointer;
}

textarea{
    width:100%;
    height:100%;
    background:transparent;
    color:white;
    border:none;
    outline:none;
}
</style>
</head>
<body>

<div id="loginScreen">
    <div class="loginBox">
        <h2>WebNAS Login</h2>
        <input id="username" placeholder="Username">
        <input id="password" type="password" placeholder="Password">
        <button onclick="login()">Login / Register</button>
    </div>
</div>

<div id="desktop">
    <div id="topbar">
        <div>WebNAS OS</div>
        <div id="monitor"></div>
    </div>

    <div id="sidebar">
        <div class="appBtn" onclick="openFileManager()">ðŸ“‚ File Manager</div>
        <div class="appBtn" onclick="openTerminal()">ðŸ’» Terminal</div>
        <div class="appBtn" onclick="openMonitor()">ðŸ“Š System Monitor</div>
    </div>
</div>

<script>

/* USER SYSTEM */

let users = JSON.parse(localStorage.getItem("nas_users")) || {};
let currentUser=null;
let fs=null;
let path=["home"];

function saveUsers(){
    localStorage.setItem("nas_users",JSON.stringify(users));
}

function login(){
    const u=document.getElementById("username").value;
    const p=document.getElementById("password").value;

    if(!users[u]){
        users[u]={password:p,fs:{home:{}}};
        saveUsers();
    }

    if(users[u].password===p){
        currentUser=u;
        fs=users[u].fs;
        document.getElementById("loginScreen").style.display="none";
        document.getElementById("desktop").style.display="block";
        startMonitor();
    } else {
        alert("Wrong password");
    }
}

/* WINDOW SYSTEM */

function createWindow(title,content){
    const win=document.createElement("div");
    win.className="window";
    win.style.top="100px";
    win.style.left="250px";

    win.innerHTML=`
    <div class="window-header">
        <span>${title}</span>
        <button onclick="this.closest('.window').remove()">X</button>
    </div>
    <div class="window-content">${content}</div>
    `;

    document.getElementById("desktop").appendChild(win);
    drag(win);
}

function drag(el){
    const header=el.querySelector(".window-header");
    let isDown=false,offsetX,offsetY;

    header.onmousedown=e=>{
        isDown=true;
        offsetX=e.clientX-el.offsetLeft;
        offsetY=e.clientY-el.offsetTop;
    };

    document.onmouseup=()=>isDown=false;

    document.onmousemove=e=>{
        if(isDown){
            el.style.left=e.clientX-offsetX+"px";
            el.style.top=e.clientY-offsetY+"px";
        }
    };
}

/* FILE SYSTEM */

function getDir(){
    let dir=fs;
    path.forEach(p=>dir=dir[p]);
    return dir;
}

/* FILE MANAGER */

function openFileManager(){
    let html="<h3>Files</h3>";
    Object.keys(getDir()).forEach(name=>{
        html+=`<div>${name}</div>`;
    });
    html+=`<button onclick="createFile()">New File</button>`;
    createWindow("File Manager",html);
}

function createFile(){
    const name=prompt("File name:");
    if(!name) return;
    getDir()[name]="";
    saveUsers();
}

/* TERMINAL */

function openTerminal(){
    createWindow("Terminal",`
        <div id="termOutput"></div>
        <input id="termInput" style="width:100%;background:black;color:#0f0;">
    `);

    const input=document.getElementById("termInput");
    const output=document.getElementById("termOutput");

    input.addEventListener("keydown",e=>{
        if(e.key==="Enter"){
            const cmd=input.value;
            output.innerHTML+="<div>> "+cmd+"</div>";
            executeTerminal(cmd,output);
            input.value="";
        }
    });
}

function executeTerminal(cmd,out){
    const [c,arg]=cmd.split(" ");

    switch(c){
        case "ls":
            out.innerHTML+="<div>"+Object.keys(getDir()).join(" ")+"</div>";
            break;
        case "mkdir":
            getDir()[arg]={};
            saveUsers();
            break;
        case "touch":
            getDir()[arg]="";
            saveUsers();
            break;
        case "pwd":
            out.innerHTML+="<div>/"+path.join("/")+"</div>";
            break;
        case "clear":
            out.innerHTML="";
            break;
        default:
            out.innerHTML+="<div>Command not found</div>";
    }
}

/* SYSTEM MONITOR */

function openMonitor(){
    createWindow("System Monitor",`
        <div id="cpu">CPU: 0%</div>
        <div id="ram">RAM: 0%</div>
    `);
}

function startMonitor(){
    setInterval(()=>{
        document.getElementById("monitor").innerText=
        "CPU "+Math.floor(Math.random()*60)+"% | RAM "+Math.floor(Math.random()*80)+"%";
    },2000);
}

</script>
</body>
</html>
